<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InsightFlow Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; }
        .toggle-dot { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        input:checked ~ .toggle-dot { transform: translateX(100%); background-color: white; }
        input:checked ~ .toggle-bg { background-color: #6366f1; }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6">

    <div class="w-full max-w-sm bg-white rounded-[2.5rem] p-8 shadow-xl border border-slate-100">
        <div class="flex justify-between items-center mb-10">
            <div class="flex items-center gap-2">
                <div class="bg-indigo-50 p-2 rounded-xl text-indigo-600">
                    <i data-lucide="zap"></i>
                </div>
                <span class="font-bold text-slate-800">InsightFlow</span>
            </div>
            <span id="badge" class="text-[10px] bg-slate-100 text-slate-500 px-2 py-1 rounded-full font-bold">OFFLINE</span>
        </div>

        <div id="display" class="min-h-[250px] flex flex-col justify-center transition-all duration-500">
            <h2 id="tip-title" class="text-xl font-bold text-slate-900 mb-4">Inicie o Fluxo</h2>
            <p id="tip-desc" class="text-slate-500 text-sm leading-relaxed italic">Ative o toggle abaixo para receber insights no seu app ntfy a cada 15s.</p>
        </div>

        <div class="mt-8 pt-8 border-t border-slate-50 space-y-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Notificações Remotas</p>
                    <p id="status-text" class="text-sm font-medium text-slate-600">Aguardando ativação...</p>
                </div>
                <label class="relative flex items-center cursor-pointer">
                    <input type="checkbox" id="toggle-notif" class="sr-only" onchange="toggleFlow(this)">
                    <div class="toggle-bg w-12 h-7 bg-slate-200 rounded-full shadow-inner transition-colors"></div>
                    <div class="toggle-dot absolute left-1 top-1 bg-white w-5 h-5 rounded-full shadow-sm"></div>
                </label>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // CONFIGURAÇÃO: Coloque aqui o nome que você criou no app ntfy
        const NTFY_TOPIC = "insights_vendas_premium_99"; 
        
        const insights = [
            { t: "Escuta Ativa", d: "Ouça 80% do tempo. O cliente entrega a objeção e a solução na fala dele." },
            { t: "Ancoragem", d: "Apresente o valor do investimento maior antes de revelar o preço final." },
            { t: "Pós-Venda", d: "A sua próxima venda começa no sucesso da entrega atual. Acompanhe o cliente." },
            { t: "Gatilho de Autoridade", d: "Demonstre domínio técnico. O cliente compra de quem transmite segurança." },
            { t: "Follow-up", d: "80% das vendas ocorrem após o 5º contato. Seja persistente e educado." }
            // Adicione mais aqui...
        ];

        let flowInterval = null;

        async function sendPush(title, message) {
            try {
                await fetch(`https://ntfy.sh/${NTFY_TOPIC}`, {
                    method: 'POST',
                    body: message,
                    headers: {
                        'Title': title,
                        'Priority': 'high',
                        'Tags': 'bulb,money_with_wings'
                    }
                });
                console.log("Push enviado com sucesso");
            } catch (err) {
                console.error("Erro ao enviar push:", err);
            }
        }

        function updateContent() {
            const random = insights[Math.floor(Math.random() * insights.length)];
            
            // Update UI
            const display = document.getElementById('display');
            display.style.opacity = 0;
            
            setTimeout(() => {
                document.getElementById('tip-title').innerText = random.t;
                document.getElementById('tip-desc').innerText = random.d;
                display.style.opacity = 1;
                
                // Enviar para o Celular via ntfy
                sendPush(random.t, random.d);
            }, 300);
        }

        function toggleFlow(el) {
            const statusText = document.getElementById('status-text');
            const badge = document.getElementById('badge');

            if (el.checked) {
                statusText.innerText = "Sincronizado com ntfy";
                statusText.classList.add('text-indigo-600');
                badge.innerText = "ACTIVE";
                badge.classList.replace('bg-slate-100', 'bg-green-100');
                badge.classList.replace('text-slate-500', 'text-green-600');
                
                updateContent(); // Primeira execução
                flowInterval = setInterval(updateContent, 15000);
            } else {
                statusText.innerText = "Aguardando ativação...";
                statusText.classList.remove('text-indigo-600');
                badge.innerText = "OFFLINE";
                badge.classList.replace('bg-green-100', 'bg-slate-100');
                badge.classList.replace('text-green-600', 'text-slate-500');
                
                clearInterval(flowInterval);
            }
        }
    </script>
</body>
</html>
